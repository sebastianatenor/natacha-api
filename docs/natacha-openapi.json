{"openapi":"3.1.0","info":{"title":"FastAPI","version":"0.1.0"},"paths":{"/v1/memory/add":{"post":{"tags":["v1"],"summary":"V1 Memory Add","operationId":"v1_memory_add_v1_memory_add_post","requestBody":{"content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Payload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/memory/search":{"get":{"tags":["v1"],"summary":"V1 Memory Search","operationId":"v1_memory_search_v1_memory_search_get","parameters":[{"name":"project","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Project"}},{"name":"channel","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Channel"}},{"name":"query","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Query"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":100,"default":20,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/health":{"get":{"summary":"Health","operationId":"health_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/health/deps":{"get":{"summary":"Health Deps","description":"Chequeos no destructivos:\n- Import y cliente de Firestore (en runtime, con try/except)\n- Lectura mínima (limit=1) protegida\n- Exposición de env no sensibles","operationId":"health_deps_health_deps_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/health/debug_source":{"get":{"summary":"Health Debug Source","description":"Ruta del archivo en runtime y SHA256 del módulo.","operationId":"health_debug_source_health_debug_source_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/ops/snapshot":{"post":{"tags":["ops"],"summary":"Take Snapshot","operationId":"take_snapshot_ops_snapshot_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/ops/snapshots":{"get":{"tags":["ops"],"summary":"List Snapshots","operationId":"list_snapshots_ops_snapshots_get","parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":10,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/ops/summary":{"get":{"tags":["ops"],"summary":"Ops Summary","operationId":"ops_summary_ops_summary_get","parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":10,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/ops/insights":{"get":{"tags":["ops"],"summary":"Ops Insights","operationId":"ops_insights_ops_insights_get","parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":20,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/ops/debug_source":{"get":{"tags":["ops"],"summary":"Ops Debug Source","operationId":"ops_debug_source_ops_debug_source_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/ops/self_register":{"post":{"tags":["ops"],"summary":"Self Register","description":"Persiste metadatos de runtime en /app/RUNTIME.json\ntomando datos del payload o, si faltan, de variables de entorno.","operationId":"self_register_ops_self_register_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/memory/add":{"post":{"tags":["memory"],"summary":"Memory Add","operationId":"memory_add_memory_add_post","requestBody":{"content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Payload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/memory/search":{"get":{"tags":["memory","memory"],"summary":"Memory Search Safe","description":"Versión con fallback: si Firestore pide índice, traemos últimos por timestamp\ny filtramos en memoria para evitar 500.","operationId":"memory_search_safe_memory_search_get","parameters":[{"name":"project","in":"query","required":false,"schema":{"type":"string","title":"Project"}},{"name":"channel","in":"query","required":false,"schema":{"type":"string","title":"Channel"}},{"name":"query","in":"query","required":false,"schema":{"type":"string","title":"Query"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":100,"default":20,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/live":{"get":{"summary":"Live","operationId":"live_live_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/ready":{"get":{"summary":"Ready","operationId":"ready_ready_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/meta":{"get":{"summary":"Meta","operationId":"meta_meta_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/v1/tasks/add":{"post":{"tags":["v1"],"summary":"V1 Tasks Add","operationId":"v1_tasks_add_v1_tasks_add_post","requestBody":{"content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Payload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/tasks/search":{"get":{"tags":["v1"],"summary":"V1 Tasks Search","operationId":"v1_tasks_search_v1_tasks_search_get","parameters":[{"name":"project","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Project"}},{"name":"state","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"State"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":200,"minimum":1,"default":20,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/tasks/update":{"post":{"tags":["v1"],"summary":"V1 Tasks Update","operationId":"v1_tasks_update_v1_tasks_update_post","requestBody":{"content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Payload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/actions/catalog":{"get":{"tags":["actions"],"summary":"List available agent actions","operationId":"actions_catalog_actions_catalog_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/auto/list_repo":{"get":{"tags":["auto"],"summary":"Auto List Repo","operationId":"auto_list_repo_auto_list_repo_get","parameters":[{"name":"subdir","in":"query","required":false,"schema":{"type":"string","description":"Subcarpeta dentro del repo","default":".","title":"Subdir"},"description":"Subcarpeta dentro del repo"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auto/show_file":{"get":{"tags":["auto"],"summary":"Auto Show File","operationId":"auto_show_file_auto_show_file_get","parameters":[{"name":"path","in":"query","required":true,"schema":{"type":"string","description":"Ruta relativa dentro del repo","title":"Path"},"description":"Ruta relativa dentro del repo"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auto/plan_refactor":{"post":{"tags":["auto"],"summary":"Auto Plan Refactor","description":"Analiza el repo y propone una limpieza/refactor.\n- detecta backups\n- genera un reporte\n- crea una tarea en /tasks/add (local → pública → memory)","operationId":"auto_plan_refactor_auto_plan_refactor_post","requestBody":{"content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Payload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/cog/reflect":{"post":{"tags":["cog"],"summary":"Store reflection about an action execution","operationId":"reflect_cog_reflect_post","requestBody":{"content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Payload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/cog/score":{"post":{"tags":["cog"],"summary":"Store runtime scores/metrics","operationId":"score_cog_score_post","requestBody":{"content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Payload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/cog/suggest":{"get":{"tags":["cog"],"summary":"Heuristic suggestions from recent meta","operationId":"suggest_cog_suggest_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/dashboard/data":{"get":{"tags":["core"],"summary":"Dashboard Data","description":"Devuelve un resumen limpio del estado operativo de Natacha,\nlisto para mostrar en el dashboard visual.","operationId":"dashboard_data_dashboard_data_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/memory/embed":{"post":{"tags":["embeddings"],"summary":"Memory Embed","description":"Guarda una memoria **con vector**.\npayload:\n  summary (str) *\n  detail (str)\n  project (str)\n  channel (str)","operationId":"memory_embed_memory_embed_post","requestBody":{"content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Payload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/memory/search_vector":{"post":{"tags":["embeddings"],"summary":"Memory Search Vector","description":"Busca memorias por similitud de vector.\npayload:\n  query (str) *\n  project (str)\n  limit (int)","operationId":"memory_search_vector_memory_search_vector_post","requestBody":{"content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Payload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/memory/v2/store":{"post":{"tags":["memory-v2"],"summary":"Store","operationId":"store_memory_v2_store_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MemoryStoreRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/memory/v2/search":{"post":{"tags":["memory-v2"],"summary":"Search","operationId":"search_memory_v2_search_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MemoryQuery"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/memory/v2/compact":{"post":{"tags":["memory-v2"],"summary":"Compact Store","operationId":"compact_store_memory_v2_compact_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/memory/v2/ops/memory-info":{"get":{"tags":["memory-v2"],"summary":"Memory Info","operationId":"memory_info_memory_v2_ops_memory_info_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/openapi.v1.json":{"get":{"summary":"Openapi V1","operationId":"openapi_v1_openapi_v1_json_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/memory/search_smart":{"post":{"tags":["semantic"],"summary":"Search Smart","description":"Busca memorias similares por significado aproximado (versión simple, sin embeddings).","operationId":"search_smart_memory_search_smart_post","requestBody":{"content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Payload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/tasks/add":{"post":{"summary":"Tasks Add","description":"Crea/actualiza una tarea en Firestore con deduplicación por (project,title,paths).\nSi existe una tarea 'pending' o 'vigente' con la misma key, hace append único de 'evidence'.","operationId":"tasks_add_tasks_add_post","requestBody":{"content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Payload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/tasks/list":{"get":{"summary":"Tasks List","description":"Lista tareas desde Firestore (assistant_tasks), con filtros simples.","operationId":"tasks_list_tasks_list_get","parameters":[{"name":"project","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Project"}},{"name":"state","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"State"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":200,"minimum":1,"default":20,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/tasks/update":{"post":{"summary":"Tasks Update","description":"Actualiza campos simples de una tarea: state, due, title, detail, project, channel.\nRequiere: id","operationId":"tasks_update_tasks_update_post","requestBody":{"content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Payload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"MemoryItem":{"properties":{"text":{"type":"string","minLength":1,"title":"Text"},"tags":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Tags"},"meta":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Meta"},"embedding":{"anyOf":[{"items":{"type":"number"},"type":"array"},{"type":"null"}],"title":"Embedding"}},"type":"object","required":["text"],"title":"MemoryItem"},"MemoryQuery":{"properties":{"query":{"type":"string","title":"Query"},"top_k":{"type":"integer","title":"Top K","default":10},"tags":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Tags"},"use_semantic":{"type":"boolean","title":"Use Semantic","default":true}},"type":"object","required":["query"],"title":"MemoryQuery"},"MemoryStoreRequest":{"properties":{"items":{"items":{"$ref":"#/components/schemas/MemoryItem"},"type":"array","title":"Items"}},"type":"object","required":["items"],"title":"MemoryStoreRequest"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}